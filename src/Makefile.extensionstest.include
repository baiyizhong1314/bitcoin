bin_PROGRAMS += extensions/test/test_bitcoin-extensions
TESTS += extensions/test/test_bitcoin-extensions

BITCOIN_EXTENSIONS_TESTS = \
  extensions/test/ecdsa_modification_tests.cpp \
  extensions/test/obfuscation_tests.cpp \
  extensions/test/encoding_speed_tests.cpp \
  extensions/test/test_bitcoin_extensions.cpp

nodist_extensions_test_test_bitcoin_extensions_SOURCES =

extensions_test_test_bitcoin_extensions_SOURCES = $(BITCOIN_EXTENSIONS_TESTS)

extensions_test_test_bitcoin_extensions_CPPFLAGS = $(BITCOIN_INCLUDES) -I$(builddir)/extensions/test/ $(TESTDEFS)

extensions_test_test_bitcoin_extensions_LDADD = $(LIBBITCOIN_SERVER) $(LIBBITCOIN_CLI) $(LIBBITCOIN_COMMON) $(LIBBITCOIN_UTIL) $(LIBBITCOIN_CRYPTO) $(LIBBITCOIN_UNIVALUE) $(LIBLEVELDB) $(LIBMEMENV) \
  $(BOOST_LIBS) $(BOOST_UNIT_TEST_FRAMEWORK_LIB) $(LIBSECP256K1) $(LIBBITCOIN_WALLET)

#if ENABLE_WALLET
extensions_test_test_bitcoin_extensions_LDADD += $(LIBBITCOIN_WALLET)
#endif

extensions_test_test_bitcoin_extensions_LDADD += $(LIBBITCOIN_CONSENSUS) $(BDB_LIBS) $(SSL_LIBS) $(CRYPTO_LIBS) $(MINIUPNPC_LIBS)
extensions_test_test_bitcoin_extensions_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS) -static

CLEAN_BITCOIN_EXTENSIONS_TEST = extensions/test/*.gcda extensions/test/*.gcno

CLEANFILES += $(CLEAN_BITCOIN_EXTENSIONS_TEST)

test_bitcoin_extensions : extensions/test/test_bitcoin-extensions$(EXEEXT)

test_bitcoin_extensions_check : extensions/test/test_bitcoin-extensions$(EXEEXT) FORCE
	$(MAKE) check-TESTS TESTS=$^

test_bitcoin_extensions_clean: FORCE
	rm -f $(CLEAN_BITCOIN_EXTENSIONS_TEST) $(extensions_test_test_bitcoin_extensions_OBJECTS)
